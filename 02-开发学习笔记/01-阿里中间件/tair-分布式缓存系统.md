参考文档：https://www.atatech.org/articles/139600?spm=a1z2e.8101737.webpage.dtitle0.243b4f9bZlPnj0

[tair产品文档](https://yuque.antfin-inc.com/tair-userdoc?spm=a1zco.tair.0.0.11b82588XnbNE6)

### 一、overview

#### 1 是什么？

<font color=red>缓存中间件</font>

Tair 是一个类似于map的key/value结构存储系统（也就是缓存系统），具备标准的特性是：高性能、高扩展、高可靠，也就是传说中的三高产品，支持分布式集群部署。官网说目前支持java和c这两个版本。

**高性能**——基于高速缓存、内存或者ssd

**高扩展**——轻量中间件+三种数据引擎+负载均衡

**高可用**——各种容灾部署方式和解决方案（见3.3）

#### 2 主要功能

**数据库缓存**——作为数据库与dao层之间的中间缓存，降低对后端数据库的访问压力，高速缓存能使得访问速度达到1ms级别，例如高频率的数据库查询；

**临时数据存储**——应用程序需要维护大量临时数据，将临时数据存储在mdb中，可以降低内存管理的开销，改进应用程序工作负载。例如：在分布式系统中，同一个用户的不同请求可能会发送到不同的服务器上，这时可以用mdb作为全局存储，用于保存Session数据、用户的Token、权限信息等数据。【通常将缓存和临时数据存储统称为“非持久化存储”】

**持久化存储**——此时类似于传统的数据库，将数据存入磁盘中做持久化存储，例如广告推荐类需要离线计算大量数据以及榜单的生成（注意：由于此时采用的数据库引擎ldb是NoSQL类型的，所以不支持sql查询）

#### 3 三种存储引擎

tair有三种存储引擎：mdb、ldb、rdb，从名字上就可以看出，分别对应memcache、leveldb、redis。

| **名称** | 基于数据库                    | 特点                                                         | 适用场景                                                     |
| -------- | ----------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| MDB      | Memcache 分级key缓存          | 基于内存；<br />仅支持k-v类型数据；<br />不支持持久化        | 数据小而简单，读多（QPS万以上）写少，且偶尔数据丢失不应该对业务产生较大影响；<br />例如访问量显示，session manager等功能 |
| RDB      | Redis 复杂数据结构缓存        | 基于内存；<br />除了k-v，还支持string、list、hash、set、sortedset等数据类型；<br />支持一定程度的持久化（其方式和LDB不同） | 数据形式复杂，偶尔丢失数据不应该对业务产生较大影响；<br />例如排行榜、最新项目检索、地理位置存储和range查询等。 |
| LDB      | LevelDB 分级key存储，数据排序 | 基于ssd硬盘；<br />仅支持k-v类型数据；<br />支持持久化       | 数据简单，有持久化需求，且读写QPS较高（万级别）但存储数据较简单的应用场景；<br />例如订单计数、库存记录等功能，更新非常频繁。 |

在一些特定场景，还会使用到localcache，常见的会用到guava cache。

- localcache(guava cache)

### 二、缓存使用中需要注意的点

参考文档：https://www.jianshu.com/p/c1b9ec30b994